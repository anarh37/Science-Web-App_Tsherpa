<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³¼í•™ ì‹¤í—˜ ì‹œë®¬ë ˆì´í„°: ì§€ì‹œì•½ ë°˜ì‘</title>
    
    <!-- êµ¬ê¸€ í°íŠ¸ 'Jua' ë¡œë“œ -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS ë¡œë“œ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 'Jua' í°íŠ¸ ê¸°ë³¸ ì ìš© */
        body {
            font-family: 'Jua', sans-serif;
            user-select: none; /* ë“œë˜ê·¸ ì¤‘ í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€ */
            min-height: 100vh;
        }

        /* [ìš”ì²­ ì‚¬í•­ ë°˜ì˜] ì œëª© ìƒ‰ìƒ ë° í¬ê¸°, ê·¸ë¦¼ì */
        .main-title {
            font-size: 3.5rem; 
            font-weight: bold;
            color: #6666FF; 
            text-shadow: 
                -2px -2px 0 #fff, 
                 2px -2px 0 #fff,
                -2px  2px 0 #fff,
                 2px  2px 0 #fff,
                 4px 4px 0 rgba(0,0,0,0.3); /* ìŠ¤í¬ë¦°ìƒ·ê³¼ ìœ ì‚¬í•œ ì…ì²´ ê·¸ë¦¼ì */
            line-height: 1.2; /* ì¤„ê°„ê²© ì¡°ì ˆ */
        }

        /* ë“œë˜ê·¸ ì¤‘ì¸ ë„êµ¬ ìŠ¤íƒ€ì¼ */
        .tool.dragging {
            cursor: grabbing;
            opacity: 0.5;
            transform: scale(1.1);
        }

        /* í„°ì¹˜ ë“œë˜ê·¸ ì‹œ ë³µì œë˜ëŠ” ìš”ì†Œ ìŠ¤íƒ€ì¼ */
        .ghost-tool {
            position: absolute;
            pointer-events: none;
            opacity: 0.7;
            z-index: 1000;
            transform: translate(-50%, -50%); /* í„°ì¹˜ í¬ì¸í„° ì¤‘ì•™ì— ì˜¤ë„ë¡ */
        }

        /* [ìˆ˜ì •ë¨] ì‹¤í—˜ ë„êµ¬ ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ (ì„¸ë¡œ ê¸¸ì´ ì¦ê°€) */
        .tool {
            width: 100px; 
            height: 100px; /* 80px -> 100px */
            border-width: 1px;
            border-style: solid; 
            cursor: grab;
            transition: all 0.2s;
            display: flex;
            justify-content: center;
            align-items: center; 
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            box-sizing: border-box;
        }
        
        /* ê° ë„êµ¬ë³„ ì„ì‹œ ìŠ¤íƒ€ì¼ */
        #tool-red-litmus { background-color: #fce8e8; border-color: #efb8b8; }
        #tool-blue-litmus { background-color: #e8f0fc; border-color: #b8cdef; }
        #tool-phenolphthalein { background-color: #f0f0f0; border-color: #c0c0c0; }


        /* [ì¶”ê°€ë¨] ë„êµ¬ ì˜ì—­ì˜ ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ */
        .tool img {
             object-fit: contain;
        }
        /* [ìˆ˜ì •ë¨] ë¦¬íŠ¸ë¨¸ìŠ¤ ì´ë¯¸ì§€ í¬ê¸°/ëª¨ì–‘ (ì„¸ë¡œ ê¸¸ì´ ì¦ê°€) */
        #tool-red-litmus img,
        #tool-blue-litmus img {
            width: 80px;
            height: 65px; /* 50px -> 65px */
            border-radius: 18px; /* íƒ€ì›í˜• ìœ ì§€ */
            object-fit: cover;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2) inset;
        }
        /* [ìˆ˜ì •ë¨] í˜ë†€í”„íƒˆë ˆì¸ ì´ë¯¸ì§€ í¬ê¸° (ì„¸ë¡œ ê¸¸ì´ ì¦ê°€) */
        #tool-phenolphthalein img {
            width: 36px;
            height: 75px; /* 60px -> 75px */
        }


        /* ë¦¬íŠ¸ë¨¸ìŠ¤ ì¢…ì´ ê²°ê³¼ (ì› ì•ˆì— í‘œì‹œë¨) */
        .litmus-paper-result {
            width: 80px; 
            height: 35px; 
            border-radius: 18px; /* íƒ€ì›í˜• */
            border: 1px solid #555;
            font-size: 0.9em;
            font-weight: bold;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2) inset;
        }

        /* ìš©ì•¡ ë¼ë²¨ ìŠ¤íƒ€ì¼ */
        .well .label {
            position: absolute; 
            bottom: 8px; /* í™ˆ ë°”ë‹¥ì—ì„œ ë„ìš°ê¸° */
            width: 100%; 
            font-size: 0.9em; 
            font-weight: bold;
            color: #555;
            text-align: center;
        }

        /* ìš©ì•¡ ì› (í™ˆ ì•ˆì˜ ì‹¤ì œ ìš©ì•¡ ì˜ì—­) */
        .well .solution {
            width: 75px; 
            height: 75px; 
            margin: 10px auto 0; 
            border: 1px solid #d0d0d0; 
            border-radius: 50%;
            background-color: transparent;
            transition: background-color 0.3s ease;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative; 
            box-shadow: 0 0 5px rgba(0,0,0,0.05) inset;
        }

        /* ê° í™ˆ(well) ì»¨í…Œì´ë„ˆ */
        .well {
            position: relative; 
            width: 110px; 
            height: 130px; 
            border: 1px solid #eee; 
            border-radius: 8px;
            background-color: #f9f9f9; 
            display: flex;
            flex-direction: column; 
            align-items: center;
            justify-content: flex-start; 
            padding-top: 5px; 
        }
        
        /* 6í™ˆíŒ ì „ì²´ */
        .well-plate {
            display: grid;
            grid-template-columns: repeat(3, 1fr); 
            grid-template-rows: repeat(2, 1fr); 
            gap: 8px; 
            background-color: #ffffff;
            border: 1px solid #e0e0e0; 
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05); 
            width: fit-content; 
            margin: 0 auto; 
        }

        /* ê° ì‹¤í—˜ ì„¸íŠ¸ íƒ€ì´í‹€ */
        .experiment-set h2 {
            font-size: 1.8em; 
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .experiment-set h2::before {
            content: 'ğŸ§ª'; 
            margin-right: 8px;
            font-size: 1.2em;
        }

        /* ì „ì²´ ë ˆì´ì•„ì›ƒ ì¡°ì • */
        .lab-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        .experiments-wrapper {
            display: flex;
            flex-direction: row; 
            gap: 40px; 
            justify-content: center;
            flex-wrap: wrap; 
        }

        /* ì‹¤í—˜ ë„êµ¬ ì˜ì—­ */
        .tools-area {
            display: flex;
            gap: 20px; 
            justify-content: center;
            margin-top: 20px; 
            flex-wrap: wrap;
        }
        .tool-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            font-size: 0.9em;
            color: #333;
        }
        .tool-item p {
            margin-top: 8px; 
            line-height: 1.2;
        }

        /* [ì¶”ê°€ë¨] ë™ì  ê°€ì´ë“œ Pulse ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes pulse-animation {
            0% {
                box-shadow: 0 0 0 0 rgba(0, 123, 255, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(0, 123, 255, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(0, 123, 255, 0);
            }
        }
        .pulsing-guide {
            animation: pulse-animation 1.5s infinite;
            border-radius: 8px; /* ê¸°ë³¸ ë‘¥ê·¼ ëª¨ì„œë¦¬ */
            box-shadow: 0 0 0 0 rgba(0, 123, 255, 0.7); 
        }
        /* .tool í´ë˜ìŠ¤ì— ì ìš©ë  ë•Œ ë‘¥ê·¼ ëª¨ì„œë¦¬ ìœ ì§€ */
        .tool.pulsing-guide {
             border-radius: 6px;
        }


    </style>
</head>
<body class="bg-gray-100 p-8 flex flex-col items-center">

    <!-- [ìš”ì²­ ì‚¬í•­ ë°˜ì˜] ì œëª© ìƒ‰ìƒ ë° í¬ê¸°, ê·¸ë¦¼ì -->
    <h1 class="main-title mb-6">
        ì§€ì‹œì•½ ìƒ‰ê¹” ë³€í™” ì‹¤í—˜
    </h1>

    
    <!-- [ì‚­ì œë¨] ì‚¬ìš© ë°©ë²• ì•ˆë‚´ ìƒì -->
    <!-- 
    <div id="instructions-box" class="w-full max-w-[792px] mx-auto p-4 mb-8 bg-blue-100 border border-blue-300 text-blue-800 rounded-lg shadow text-center text-lg">
        <p class="font-bold">âœ¨ ì‚¬ìš© ë°©ë²•</p>
        <div class="flex flex-col items-start w-fit mx-auto mt-2 text-base">
            <p class="text-left">- ì•„ë˜ì˜ ì‹¤í—˜ë„êµ¬(ë¦¬íŠ¸ë¨¸ìŠ¤ì¢…ì´, í˜ë†€í”„íƒˆë ˆì¸ ìš©ì•¡)ì„ ëŒì–´ 6í™ˆíŒì— ë†“ì•„ ë³´ì„¸ìš”.</p>
            <p class="text-left">- ë¦¬íŠ¸ë¨¸ìŠ¤ ì¢…ì´ì™€, í˜ë†€í”„íƒˆë ˆì¸ì˜ ìƒ‰ê¹” ë³€í™”ë¥¼ ê´€ì°°í•´ ë³´ì„¸ìš”.</p>
        </div>
    </div>
    -->


    <div class="lab-container">
        <div class="experiments-wrapper">
            
            <!-- ë¦¬íŠ¸ë¨¸ìŠ¤ ì¢…ì´ ì‹¤í—˜ -->
            <div class="experiment-set flex flex-col items-center">
                <h2>ë¦¬íŠ¸ë¨¸ìŠ¤ ì¢…ì´ ì‹¤í—˜</h2>
                <div class="well-plate" id="litmus-plate">
                    
                    <div class="well" data-type="acid" data-solution="vinegar">
                        <div class="solution"></div>
                        <div class="label">ì‹ì´ˆ</div>
                    </div>
                    <div class="well" data-type="acid" data-solution="carbonated-water">
                        <div class="solution"></div>
                        <div class="label">íƒ„ì‚°ìˆ˜</div>
                    </div>
                    <div class="well" data-type="base" data-solution="limewater">
                        <div class="solution"></div>
                        <div class="label">ì„íšŒìˆ˜</div>
                    </div>
                    <div class="well" data-type="acid" data-solution="hydrochloric-acid">
                        <div class="solution"></div>
                        <div class="label">ë¬½ì€ ì—¼ì‚°</div>
                    </div>
                    <div class="well" data-type="base" data-solution="glass-cleaner">
                        <!-- ìœ ë¦¬ ì„¸ì •ì œ ì´ˆê¸° ìƒ‰ìƒ (í•˜ëŠ˜ìƒ‰) -->
                        <div class="solution bg-cyan-100"></div>
                        <div class="label">ìœ ë¦¬ ì„¸ì •ì œ</div>
                    </div>
                    <div class="well" data-type="base" data-solution="sodium-hydroxide">
                        <div class="solution"></div>
                        <div class="label">ë¬½ì€ ìˆ˜ì‚°í™”ë‚˜íŠ¸ë¥¨</div>
                    </div>
                </div>
            </div>

            <!-- í˜ë†€í”„íƒˆë ˆì¸ ìš©ì•¡ ì‹¤í—˜ -->
            <div class="experiment-set flex flex-col items-center">
                <h2>í˜ë†€í”„íƒˆë ˆì¸ ìš©ì•¡ ì‹¤í—˜</h2>
                <div class="well-plate" id="phen-plate">
                    <div class="well" data-type="acid" data-solution="vinegar">
                        <div class="solution"></div>
                        <div class="label">ì‹ì´ˆ</div>
                    </div>
                    <div class="well" data-type="acid" data-solution="carbonated-water">
                        <div class="solution"></div>
                        <div class="label">íƒ„ì‚°ìˆ˜</div>
                    </div>
                    <div class="well" data-type="base" data-solution="limewater">
                        <div class="solution"></div>
                        <div class="label">ì„íšŒìˆ˜</div>
                    </div>
                    <div class="well" data-type="acid" data-solution="hydrochloric-acid">
                        <div class="solution"></div>
                        <div class="label">ë¬½ì€ ì—¼ì‚°</div>
                    </div>
                    <div class="well" data-type="base" data-solution="glass-cleaner">
                        <!-- ìœ ë¦¬ ì„¸ì •ì œ ì´ˆê¸° ìƒ‰ìƒ (í•˜ëŠ˜ìƒ‰) -->
                        <div class="solution bg-cyan-100"></div>
                        <div class="label">ìœ ë¦¬ ì„¸ì •ì œ</div>
                    </div>
                    <div class="well" data-type="base" data-solution="sodium-hydroxide">
                        <div class="solution"></div>
                        <div class="label">ë¬½ì€ ìˆ˜ì‚°í™”ë‚˜íŠ¸ë¥¨</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- [ìˆ˜ì •ë¨] ì‹¤í—˜ ë„êµ¬ (id="tools-area" ì¶”ê°€) -->
        <div id="tools-area" class="tools-area">
            
            <!-- [ìˆ˜ì •ë¨] ë¶‰ì€ìƒ‰ ë¦¬íŠ¸ë¨¸ìŠ¤ (CSS -> ì´ë¯¸ì§€) -->
            <div class="tool-item">
                <div class="tool" id="tool-red-litmus" draggable="true">
                    <!-- <div class="litmus-tool-shape">ë¶‰ì€ìƒ‰</div> -->
                    <img src="red.png" alt="ë¶‰ì€ìƒ‰ ë¦¬íŠ¸ë¨¸ìŠ¤ ì¢…ì´">
                </div>
                <p>ë¦¬íŠ¸ë¨¸ìŠ¤<br>ì¢…ì´</p>
            </div>
            
            <!-- [ìˆ˜ì •ë¨] í‘¸ë¥¸ìƒ‰ ë¦¬íŠ¸ë¨¸ìŠ¤ (CSS -> ì´ë¯¸ì§€) -->
            <div class="tool-item">
                <div class="tool" id="tool-blue-litmus" draggable="true">
                    <!-- <div class="litmus-tool-shape">í‘¸ë¥¸ìƒ‰</div> -->
                    <img src="blue.png" alt="í‘¸ë¥¸ìƒ‰ ë¦¬íŠ¸ë¨¸ìŠ¤ ì¢…ì´">
                </div>
                <p>ë¦¬íŠ¸ë¨¸ìŠ¤<br>ì¢…ì´</p>
            </div>
            
            <!-- [ìˆ˜ì •ë¨] í˜ë†€í”„íƒˆë ˆì¸ (SVG -> ì´ë¯¸ì§€) -->
            <div class="tool-item">
                <div class="tool" id="tool-phenolphthalein" draggable="true">
                    <!-- SVG ì ì ë³‘ ì•„ì´ì½˜ (ì œê±°ë¨) -->
                    <img src="phenolphthalein.png" alt="í˜ë†€í”„íƒˆë ˆì¸ ìš©ì•¡">
                </div>
                <p>í˜ë†€í”„íƒˆë ˆì¸<br>ìš©ì•¡</p>
            </div>

        </div>

        <!-- ê°„ê²© ìˆ˜ì • ì™„ë£Œ -->
        <button id="reset-button" class="mt-4 px-6 py-3 text-lg font-bold text-white bg-red-500 rounded-lg shadow-md cursor-pointer hover:bg-red-600 transition-colors">
            ì²˜ìŒë¶€í„° ë‹¤ì‹œí•˜ê¸°
        </button>
    </div>

    <!-- [ì¶”ê°€ë¨] íš¨ê³¼ìŒìš© ì˜¤ë””ì˜¤ íƒœê·¸ -->
    <audio id="water-sound" src="water.mp3" preload="auto"></audio>
    <audio id="reaction-sound" src="reaction.mp3" preload="auto"></audio>

    <script>
        // --- [0] íš¨ê³¼ìŒ ë° ê°€ì´ë“œ DOM ìš”ì†Œ ---
        let waterSound, reactionSound;
        let instructionsBox, toolsArea; // [ìˆ˜ì •ë¨] instructionsBoxëŠ” ìˆì§€ë§Œ, ì‚¬ìš©í•˜ì§€ ì•ŠìŒ

        // [ì¶”ê°€ë¨] íš¨ê³¼ìŒ ì¬ìƒ í•¨ìˆ˜
        function playSound(sound) {
            if (sound) {
                sound.currentTime = 0;
                sound.volume = 0.5; // 0.0 ~ 1.0
                sound.play().catch(e => console.error("ì˜¤ë””ì˜¤ ì¬ìƒ ì˜¤ë¥˜:", e));
            }
        }

        // [ì¶”ê°€ë¨] ê°€ì´ë“œ ë°˜ì§ì„ ì œê±°
        function clearAllPulses() {
            document.querySelectorAll('.pulsing-guide').forEach(el => {
                el.classList.remove('pulsing-guide');
            });
        }

        // [ìˆ˜ì •ë¨] ê°€ì´ë“œ ë°˜ì§ì„ ì„¤ì • (instructionsBox ì œê±°)
        function updateGuide(state) {
            clearAllPulses();
            if (state === 'init') {
                // if(instructionsBox) instructionsBox.classList.add('pulsing-guide'); // [ì‚­ì œë¨]
                if(toolsArea) toolsArea.classList.add('pulsing-guide');
                // ë„êµ¬ë“¤ì—ë„ ê°œë³„ì ìœ¼ë¡œ ì¶”ê°€
                document.querySelectorAll('.tool').forEach(tool => tool.classList.add('pulsing-guide'));
            }
        }


        // --- [1] ë§ˆìš°ìŠ¤ ë“œë˜ê·¸ ì•¤ ë“œë¡­ ë¡œì§ ---
        const tools = document.querySelectorAll('.tool');
        const wells = document.querySelectorAll('.well');
        let draggedToolId = null;

        // 1-1. ë§ˆìš°ìŠ¤ ë“œë˜ê·¸ ì‹œì‘
        tools.forEach(tool => {
            tool.addEventListener('dragstart', (e) => {
                // [ìˆ˜ì •ë¨] e.targetì´ imgì¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ closestë¡œ .toolì„ ì°¾ìŒ
                const parentTool = e.target.closest('.tool');
                if (parentTool && parentTool.id) {
                    draggedToolId = parentTool.id;
                    parentTool.classList.add('dragging');
                    e.dataTransfer.setData('text/plain', draggedToolId);
                } else {
                    e.preventDefault(); 
                }
            });

            // 1-2. ë§ˆìš°ìŠ¤ ë“œë˜ê·¸ ì¢…ë£Œ
            tool.addEventListener('dragend', (e) => {
                const draggedElement = document.getElementById(draggedToolId) || e.target.closest('.tool');
                if (draggedElement) {
                    draggedElement.classList.remove('dragging');
                }
                draggedToolId = null;
            });
        });

        // 1-3. í™ˆíŒ ìœ„ì— ë“œë¡­ í—ˆìš©
        wells.forEach(well => {
            well.addEventListener('dragover', (e) => {
                e.preventDefault(); // í•„ìˆ˜: ë“œë¡­ì„ í—ˆìš©í•¨
            });

            // 1-4. í™ˆíŒì— ë§ˆìš°ìŠ¤ ë“œë¡­ (ì‹¤í—˜!)
            well.addEventListener('drop', (e) => {
                e.preventDefault();
                const toolId = e.dataTransfer.getData('text/plain');
                runExperiment(e.target, toolId);
            });
        });

        // --- [2] ëª¨ë°”ì¼ í„°ì¹˜ ë“œë˜ê·¸ ì•¤ ë“œë¡­ ë¡œì§ ---
        let draggedToolElement = null;
        let ghostElement = null;
        let isTouchDragging = false;

        tools.forEach(tool => {
            tool.addEventListener('touchstart', (e) => {
                // e.preventDefault(); // ìŠ¤í¬ë¡¤ì„ ë§‰ì„ ìˆ˜ ìˆìœ¼ë‚˜, í´ë¦­ ì´ë²¤íŠ¸ì™€ ì¶©ëŒí•  ìˆ˜ ìˆìŒ.
                draggedToolElement = e.target.closest('.tool');
                if (!draggedToolElement || !draggedToolElement.id) return;

                isTouchDragging = true;
                
                // ë“œë˜ê·¸ ì¤‘ì¸ ì‹œê°ì  í”¼ë“œë°±ìš© 'ìœ ë ¹' ìš”ì†Œ ìƒì„±
                ghostElement = draggedToolElement.cloneNode(true);
                ghostElement.classList.add('ghost-tool'); // CSS ìŠ¤íƒ€ì¼ ì ìš©
                document.body.appendChild(ghostElement);

                // í„°ì¹˜ ì‹œì‘ ìœ„ì¹˜ì—ì„œ ìš”ì†Œ ìœ„ì¹˜ ë³´ì •
                const touch = e.touches[0];
                updateGhostPosition(touch);
            }, { passive: false });
        });

        document.addEventListener('touchmove', (e) => {
            if (!isTouchDragging || !ghostElement) return;
            
            e.preventDefault(); // ìŠ¤í¬ë¡¤ ë°©ì§€
            
            const touch = e.touches[0];
            updateGhostPosition(touch);
        }, { passive: false });

        document.addEventListener('touchend', (e) => {
            if (!isTouchDragging || !ghostElement) return;

            isTouchDragging = false;
            
            // ìœ ë ¹ ìš”ì†Œë¥¼ ìˆ¨ê¸°ê³  í˜„ì¬ ìœ„ì¹˜ì˜ ìš”ì†Œ ì°¾ê¸°
            ghostElement.style.display = 'none';
            const touch = e.changedTouches[0];
            const dropTarget = document.elementFromPoint(touch.clientX, touch.clientY);
            
            // ìœ ë ¹ ìš”ì†Œ ì œê±°
            document.body.removeChild(ghostElement);
            ghostElement = null;

            if (dropTarget) {
                // í„°ì¹˜ ìœ„ì¹˜ì—ì„œ ì‹¤í—˜ ì‹¤í–‰
                runExperiment(dropTarget, draggedToolElement.id);
            }
            
            draggedToolElement = null;
        });

        function updateGhostPosition(touch) {
            if (!ghostElement) return;
            // í„°ì¹˜í•œ ìœ„ì¹˜ì˜ ì¤‘ì•™ì— ìœ ë ¹ ìš”ì†Œê°€ ì˜¤ë„ë¡
            ghostElement.style.left = `${touch.clientX}px`;
            ghostElement.style.top = `${touch.clientY}px`;
        }


        // --- [3] ê³µí†µ ì‹¤í—˜ ë¡œì§ ---
        function runExperiment(targetElement, toolId) {
            const targetWell = targetElement.closest('.well');
            if (!targetWell || !toolId) return; // í™ˆ(well)ì´ ì•„ë‹ˆê±°ë‚˜ ë„êµ¬ê°€ ì—†ìœ¼ë©´ ë¬´ì‹œ

            const solutionDiv = targetWell.querySelector('.solution');
            const solutionType = targetWell.dataset.type; // 'acid' ë˜ëŠ” 'base'
            const plateId = targetWell.closest('.well-plate').id;

            let changeOccurred = false; // [ì¶”ê°€ë¨] ë³€í™” ì—¬ë¶€ í”Œë˜ê·¸

            // [A] ë¦¬íŠ¸ë¨¸ìŠ¤ ì¢…ì´ ì‹¤í—˜íŒ ë¡œì§
            if (plateId === 'litmus-plate') {
                if (toolId === 'tool-red-litmus' || toolId === 'tool-blue-litmus') {
                    // [ìˆ˜ì •ë¨] showLitmusResultê°€ booleanì„ ë°˜í™˜í•˜ë„ë¡ í•¨
                    changeOccurred = showLitmusResult(solutionDiv, toolId, solutionType);
                }
            // [B] í˜ë†€í”„íƒˆë ˆì¸ ì‹¤í—˜íŒ ë¡œì§
            } else if (plateId === 'phen-plate') {
                if (toolId === 'tool-phenolphthalein') {
                    // [ìˆ˜ì •ë¨] showPhenolphthaleinResultê°€ booleanì„ ë°˜í™˜í•˜ë„ë¡ í•¨
                    changeOccurred = showPhenolphthaleinResult(solutionDiv, solutionType);
                }
            }

            // [ì¶”ê°€ë¨] ë³€í™” ì—¬ë¶€ì— ë”°ë¼ ë‹¤ë¥¸ íš¨ê³¼ìŒ ì¬ìƒ
            if (changeOccurred) {
                playSound(reactionSound);
            } else {
                playSound(waterSound);
            }

            // [ì¶”ê°€ë¨] ì‹¤í—˜ì´ í•œ ë²ˆì´ë¼ë„ ì‹¤í–‰ë˜ë©´ ê°€ì´ë“œ ì¤‘ì§€
            clearAllPulses();
        }


        // --- [4] ì‹¤í—˜ ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜ ---

        // 4-1. [ìˆ˜ì •ë¨] ë¦¬íŠ¸ë¨¸ìŠ¤ ì¢…ì´ ê²°ê³¼ í‘œì‹œ (ë³€í™” ì—¬ë¶€ boolean ë°˜í™˜)
        function showLitmusResult(solutionDiv, toolId, solutionType) {
            solutionDiv.innerHTML = ''; // ì´ì „ ê²°ê³¼ ì‚­ì œ
            const paper = document.createElement('div');
            paper.className = 'litmus-paper-result'; // CSS ìŠ¤íƒ€ì¼ ì ìš©
            let changed = false;

            if (toolId === 'tool-red-litmus') {
                if (solutionType === 'base') {
                    paper.style.backgroundColor = '#6666FF'; // í‘¸ë¥¸ìƒ‰ (ë³€í™”)
                    paper.innerText = 'í‘¸ë¥¸ìƒ‰';
                    changed = true; // [ìˆ˜ì •ë¨]
                } else { // acid or neutral
                    paper.style.backgroundColor = '#FF6666'; // ë¶‰ì€ìƒ‰ (ë³€í™” ì—†ìŒ)
                    paper.innerText = 'ë³€í™” ì—†ìŒ';
                    changed = false; // [ìˆ˜ì •ë¨]
                }
            } else if (toolId === 'tool-blue-litmus') {
                if (solutionType === 'acid') {
                    paper.style.backgroundColor = '#FF6666'; // ë¶‰ì€ìƒ‰ (ë³€í™”)
                    paper.innerText = 'ë¶‰ì€ìƒ‰';
                    changed = true; // [ìˆ˜ì •ë¨]
                } else { // base or neutral
                    paper.style.backgroundColor = '#6666FF'; // í‘¸ë¥¸ìƒ‰ (ë³€í™” ì—†ìŒ)
                    paper.innerText = 'ë³€í™” ì—†ìŒ';
                    changed = false; // [ìˆ˜ì •ë¨]
                }
            }
            solutionDiv.appendChild(paper);
            return changed; // [ìˆ˜ì •ë¨]
        }

        // 4-2. [ìˆ˜ì •ë¨] í˜ë†€í”„íƒˆë ˆì¸ ê²°ê³¼ í‘œì‹œ (ë³€í™” ì—¬ë¶€ boolean ë°˜í™˜)
        function showPhenolphthaleinResult(solutionDiv, solutionType) {
            if (solutionType === 'base') {
                // ì—¼ê¸°ì„± ìš©ì•¡(ì„íšŒìˆ˜, ìœ ë¦¬ì„¸ì •ì œ, ìˆ˜ì‚°í™”ë‚˜íŠ¸ë¥¨)ì€ ë¶‰ê²Œ ë³€í•¨
                solutionDiv.style.backgroundColor = '#ec4899'; // Tailwind 'pink-500' (ë§ˆì  íƒ€/ë¶‰ì€ìƒ‰)
                return true; // [ìˆ˜ì •ë¨]
            } else {
                // ì‚°ì„±(ì‹ì´ˆ, íƒ„ì‚°ìˆ˜, ì—¼ì‚°)ì€ ë¬´ìƒ‰
                solutionDiv.style.backgroundColor = 'transparent';
                return false; // [ìˆ˜ì •ë¨]
            }
        }

        // --- [5] ì´ˆê¸°í™” ë²„íŠ¼ ë¡œì§ ---
        const resetButton = document.getElementById('reset-button');
        resetButton.addEventListener('click', () => {
            resetExperiment();
        });

        function resetExperiment() {
            // 1. ë¦¬íŠ¸ë¨¸ìŠ¤ ì‹¤í—˜íŒ ì´ˆê¸°í™”
            document.querySelectorAll('#litmus-plate .well').forEach(well => {
                const solutionDiv = well.querySelector('.solution');
                const solutionName = well.dataset.solution;
                solutionDiv.innerHTML = ''; // ì¢…ì´ ì œê±°
                
                // ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™” (Tailwind í´ë˜ìŠ¤ë³´ë‹¤ ìš°ì„ ìˆœìœ„ ë†’ìŒ)
                solutionDiv.style.backgroundColor = ''; 
                // Tailwind í´ë˜ìŠ¤ ë³µì› (ìœ ë¦¬ ì„¸ì •ì œ)
                solutionDiv.classList.remove('bg-cyan-100');
                if (solutionName === 'glass-cleaner') {
                    solutionDiv.classList.add('bg-cyan-100'); // ì—°í•œ íŒŒë€ìƒ‰
                }
            });

            // 2. í˜ë†€í”„íƒˆë ˆì¸ ì‹¤í—˜íŒ ì´ˆê¸°í™”
            document.querySelectorAll('#phen-plate .well').forEach(well => {
                const solutionDiv = well.querySelector('.solution');
                const solutionName = well.dataset.solution;
                
                // ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™” (ìƒ‰ìƒ ì œê±°)
                solutionDiv.style.backgroundColor = '';
                
                // Tailwind í´ë˜ìŠ¤ ë³µì› (ìœ ë¦¬ ì„¸ì •ì œ)
                solutionDiv.classList.remove('bg-cyan-100'); // í˜¹ì‹œ ëª¨ë¥¼ í´ë˜ìŠ¤ ì œê±°
                if (solutionName === 'glass-cleaner') {
                    solutionDiv.classList.add('bg-cyan-100'); // ì—°í•œ íŒŒë€ìƒ‰
                }
            });

            // [ì¶”ê°€ë¨] ì´ˆê¸°í™” ì‹œ ê°€ì´ë“œ ë‹¤ì‹œ ì‹œì‘
            updateGuide('init');
        }

        // ì´ˆê¸° ë¡œë“œ ì‹œ ì‹¤í—˜ ìƒíƒœ ì„¤ì • 
        document.addEventListener('DOMContentLoaded', () => {
            // [ì¶”ê°€ë¨] íš¨ê³¼ìŒ ë° ê°€ì´ë“œ ìš”ì†Œ í• ë‹¹
            waterSound = document.getElementById('water-sound');
            reactionSound = document.getElementById('reaction-sound');
            // instructionsBox = document.getElementById('instructions-box'); // [ìˆ˜ì •ë¨] ìš”ì†Œë¥¼ ì°¾ì§€ë§Œ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
            toolsArea = document.getElementById('tools-area');

            resetExperiment(); // ì—¬ê¸°ì—ì„œ updateGuide('init')ì´ í˜¸ì¶œë¨
        });

    </script>
</body>
</html>
